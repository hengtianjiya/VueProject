function choseSeat(){this.option={column:26,row:14,floor:1,clickEnable:!0}}function Link(t){this.config={onchange:function(){},onclear:function(){}}}var AddItem=function(){this.config={beforeAdd:function(){return!0},afterAdd:function(){},beforeRemove:function(){return!0},afterRemove:function(){}}};AddItem.prototype={init:function(t){this.config=$.extend(!0,this.config,t),this.$addCtl=this.config.addCtl,this.$wrap=this.config.items,this.item=this.config.item,this.del=this.config.delItem,this.$copy=$(this.$wrap.find(this.item)[0]),this.$html=this.$copy.clone(),this.$h=this.$html[0].outerHTML,this.eventHandler()},eventHandler:function(){var t=this;t.$addCtl.on("click",function(){t.addItem()}),t.$wrap.on("click",t.del,function(){t.removeItem($(this))})},addItem:function(){var t=this;t.config.beforeAdd()&&($(t.$h).appendTo(t.$wrap),t.$wrap.find(t.del).show(),t.$wrap.find(t.del).eq(0).hide()),t.config.afterAdd()},removeItem:function(t){var e=this;e.config.beforeRemove(t.closest(e.item))&&t.closest(e.item).remove(),this.config.afterRemove(t.closest(e.item))}};var Catalog=function(){this.config={afterMove:function(){}}};Catalog.prototype={init:function(t){return this.config=$.extend(!0,this.config,t),this.$wrap=this.config.wrap,this.$wrap.Width=this.$wrap.width(),this.$wrap.Height=this.$wrap.height(),this.$wrap.Left=this.$wrap[0].offsetLeft,this.orderShow=this.config.order,!!this.orderShow.length&&(this.item=this.config.item,void this.eventHandler())},eventHandler:function(){var t=this;t.$ele=null,t.$wrap.on("mousedown",t.item,function(e){t.ele=e.currentTarget,t.$ele=$(e.currentTarget),t.Top=t.ele.offsetTop,t.Left=t.ele.offsetLeft,t.Width=t.ele.offsetWidth,t.Height=t.ele.offsetHeight,t.lastY=e.originalEvent.clientY,t.order=t.orderShow.val().length?t.orderShow.val().split(","):[],t.moveAble()}),t.$wrap.on("mouseup",t.item,function(e){if(!t.testEle())return!1;if(isNaN(t.finalTop))return!1;var i=t.$wrap.find(t.item).index(t.$ele),n=Math.floor(t.finalTop/t.Height);if(n<0)return!1;var o=parseInt(t.order.splice(i,1).toString());t.order.splice(n,0,o),t.orderShow.val(t.order),0!=n?t.$ele.insertAfter(t.$wrap.find(t.item)[n]):t.$ele.insertBefore(t.$wrap.find(t.item)[n]),t.moveDisble()}),t.$wrap.on("mousemove",function(e){return!!t.testEle()&&(t.finalTop=t.Top+e.originalEvent.clientY-t.lastY,t.finalTop<0?(t.finalTop=0,$(t.item).trigger("mouseup"),!1):void t.$ele.css("top",t.finalTop+"px"))}),t.$wrap.on("mouseleave",function(e){return!!t.testEle()&&void $(t.item).trigger("mouseup")})},testEle:function(){return null!==this.$ele},moveAble:function(){var t=this;t.$ele.css({position:"absolute",opacity:.5}),t.$ele.addClass("moveable")},moveDisble:function(){var t=this;return!!t.testEle()&&(t.$ele.css({position:"static",opacity:1,top:""}),t.$ele.removeClass("moveable"),t.$ele=null,void t.config.afterMove())}},choseSeat.prototype={init:function(t){this.option=$.extend(!0,this.option,t),this.getSeat(),this.eventHandler()},eventHandler:function(){if(!this.option.clickEnable)return!1;$("body").off("click",this.option.ele+" li"),$("body").on("click",this.option.ele+" li",function(){var t=$.Event("chosen.choseSeat"),e=$(this).find("div"),i=$.Event("limit.choseSeat");if(e.hasClass("sold")||e.find("> span").length<2)return!1;var n=e.data("num");return $(".chose-wrap .select").length>=n&&!e.hasClass("select")?($(this).trigger(i),!1):(e.hasClass("select")?e.removeClass("select"):e.addClass("select"),void $(this).trigger(t))})},getSeat:function(){for(var t=this.option.row,e=this.option.column,i=100/e,n="",o=$.Event("shown.choseSeat"),a=1;a<=t;a++){n+="<ul>";for(var s=1;s<=e;s++){var r="",l="",c="",h=this.option.data[a]?"100%":"";if(this.option.data[a]&&this.option.data[a][s])if("down"==this.option.data[a][s].direction||"up"==this.option.data[a][s].direction||"left"==this.option.data[a][s].direction||"right"==this.option.data[a][s].direction){l+=" up";var f=this.addclass(this.option.floor,this.option.sale,this.option.save,a,s);l+=f.className,c+=f.name,r+="<span><span>"+this.option.data[a][s].description+"</span></span><span><span>"+c+"</span></span>"}else"col"==this.option.data[a][s].direction&&(l+=" col",r+="<span><span>"+this.option.data[a][s].description+"</span></span>");var d="",u="",p=this.option.max_num,g=0;if(this.option.data[a]&&this.option.data[a][s]){d=this.option.data[a][s].value,u=this.option.data[a][s].id,this.option.data[a][s].is_vip&&""==c&&(l+=" vip");var g=this.option.data[a][s].price/100}n+='<li style="width:'+i+'%;"><div data-num="'+p+'" data-value="'+d+'" data-id="'+u+'" data-key="'+this.option.floor+"-"+a+"-"+s+'" class="'+l+'" data-floor="'+this.option.floor+'" style="padding-bottom:'+h+'" data-price="'+g+'">'+r+"</div></li>"}n+="</ul>"}$(this.option.ele).html(n),$(this.option.ele).trigger(o)},addclass:function(t,e,i,n,o){var a="",s="";return(e||i)&&(e&&e[t]||i&&i[t])&&(e&&this.isEmpty(e)&&e[t][n]&&e[t][n][o]&&(a+=" sold",s=e[t][n][o].name),i&&this.isEmpty(i)&&i[t][n]&&i[t][n][o]&&(a+=" select save")),{className:a,name:s}},isEmpty:function(t){var e=0;if(t instanceof Object)for(var i in t)e+=1;else t instanceof Array&&(e=t.length);return e}};var Fileupload=function(){this.config={format:"jpg|jpeg|png|gif",max_image_size:2097152,url:"",param:{},fileFilter:[],fileLen:0,needCut:!1,onloaderror:function(){},onread:function(){},onprogress:function(){},onsuccess:function(){},oncomplete:function(){},onfailure:function(){}}};Fileupload.prototype={init:function(t){this.config=$.extend(!0,this.config,t),this.eventHandler()},eventHandler:function(){var t=this;t.config.ele.off("change"),t.config.ele.on("change",function(e){t.funGetFile(e,this)})},cutImg:function(t){var e=$('<img src="'+t+'"/>')[0],i=e.width,n=e.width,o=e.height,a=e.height,s=0,r=0;i>o?(n=o,s=(i-n)/2):(a=i,r=(o-a)/2);var l=this.getCutImg(n,a,s,r,e);return l},getCutImg:function(t,e,i,n,o){canvas_width=t,canvas_height=e,canvas=document.createElement("canvas"),canvas.width=canvas_width,canvas.height=canvas_height;var a=canvas.getContext("2d");a.fillStyle="#ffffff",a.fillRect(0,0,canvas_width,canvas_height),a.drawImage(o,i,n,t,e,0,0,t,e);var s=canvas.toDataURL("image/jpeg");return s},funGetFile:function(t,e){function i(){var t=n.config.fileFilter[a];if(t){var o=new FileReader;o.onload=function(o){t.timeStamp=o.timeStamp,n.config.needCut?t.result=n.cutImg(o.target.result):t.result=o.target.result,n.config.onread&&n.config.onread(t,e),n.funUploadFile(t,e),a++,i()},o.readAsDataURL(t)}}var n=this,o=t.target.files,a=0;n.config.fileFilter=[],n.config.fileFilter=n.config.fileFilter.concat(n.filter(o)),n.config.fileLen=n.config.fileFilter.length,i()},funUploadFile:function(t,e){var i=this,n=new XMLHttpRequest,o=new FormData;if(n.upload){n.upload.addEventListener("progress",function(n){var o=Math.round(n.loaded/n.total*100);i.config.onprogress&&i.config.onprogress(t,o,e)},!1),n.onreadystatechange=function(o){4==n.readyState&&(200==n.status&&i.config.onsuccess&&i.config.onsuccess(t,$.parseJSON(n.responseText),e),i.config.fileLen--,i.config.fileLen<=0?(i.config.oncomplete&&i.config.oncomplete(t,e),i.config.fileLen=[],e.setAttribute("value","")):(i.config.onfailure&&i.config.onfailure(t,e),i.config.fileLen=[],e.setAttribute("value","")))},o.append("file",t);for(var a in i.config.param)o.append(a,i.config.param[a]);n.open("GET",i.config.url,!0),n.send(o)}},filter:function(t){for(var e,i=[],n=0;e=t[n];n++)this.formatRegExp(e.name)?e.size>this.config.max_image_size?this.config.onloaderror&&this.config.onloaderror("您上传的文件太大了！"):i.push(e):this.config.onloaderror&&this.config.onloaderror("您上传文件的格式不符合规则哦！");return i},formatRegExp:function(t){return new RegExp(".("+this.config.format+")$","i").test(t)}},Link.prototype={init:function(t){return this.config=$.extend(!0,{},t),this.arr=this.config.eleArr,this.l=this.arr.length,!(this.l<2)&&(this.obj=this.config.obj,this.callback=this.config.callback,void this.eventHandler())},eventHandler:function(){for(var t=this,e=0;e<t.l;e++)!function(e){t.arr[e].on("change",function(){if(0==$(this).val()){var i=e+1,n=i;t.config.onclear(n)}else{var o="";if(0==e)o="_"+t.arr[e].val();else for(var a=0;a<=e;a++)o+="_"+t.arr[a].val();var s=o.substr(1).split("_");t.config.onchange(s,t.arr[e+1])}})}(e)}};var Pop=function(){};Pop.prototype={init:function(t,e){return!!this[t]&&(this.type=t,this.option=e,void this[t]())},Toast:function(){var t=this,e=$('<div class="toast '+t.option.type+'">'+t.option.msg+"</div>").appendTo(document.body).animate({height:"0.625rem"});setTimeout(function(){e.animate({height:"0"},function(){e.remove(),t.option.toastCloseFun&&t.option.toastCloseFun()})},t.option.duration||3e3)},Alert:function(){var t=this;t.option.mask&&(this.$m=this.Mask(),this.$m.appendTo(document.body));var e=t.option.closeBtn||"确定",i=t.option.fucBtn||"",n=t.option.closeBtnStyle||"";this.$a=$('<div class="alert animated slideInDown"><div class="alert-head">'+t.option.title+'</div><div class="alert-content">'+t.option.template+'</div><div class="alert-footer">'+i+'<button class="alert-btn '+n+'">'+e+"</button></div></div>").appendTo(document.body),t.option.alertShowFun&&t.option.alertShowFun(),this.AlertEvent()},Modal:function(){var t=this;t.modal=t.option.modalEle,t.closeBtn=t.option.closeBtn||"",t.maskClickDisble=t.option.maskClickDisble,t.modal.modalShowFun=t.option.modalShowFun||function(){},t.modal.modalHideFun=t.option.modalHideFun||function(){},t.ModalEvent()},ModalEvent:function(){var t=this;t.modal.off(),t.modal.on("click",function(e){return e.target!=e.currentTarget||!t.maskClickDisble&&(t.Hide(),!1)}),t.closeBtn&&t.modal.on("click",t.closeBtn,function(){t.modal.trigger("click")})},Show:function(){var t=this;return"Modal"==t.type&&($("body").css("overflow","hidden"),t.modal.show(),t.modal.removeClass("fadeOut").addClass("fadeIn"),t.modal.one("webkitAnimationEnd animationend",function(e){return e.target==e.currentTarget&&void t.modal.modalShowFun()}),t)},Hide:function(){var t=this;return"Modal"==t.type&&($("body").css("overflow","auto"),t.modal.removeClass("fadeIn").addClass("fadeOut"),t.modal.one("webkitAnimationEnd animationend",function(e){return e.target==e.currentTarget&&(t.modal.hide(),void t.modal.modalHideFun())}),t)},AlertEvent:function(){var t=this;t.eleArr=[],t.eleArr.push(t.$a),t.option.mask&&(t.eleArr.push(t.$m),t.$m.off(),t.$m.on("click",function(){t.option.maskClickDisble||t.Remove()})),t.$a.off(),t.$a.on("click",".alert-btn",function(){t.Remove()})},Mask:function(){return $('<div class="mask animated fadeIn"></div>')},Remove:function(){var t=null,e=this;return"Alert"==e.type&&(e.$m&&e.$m.removeClass("fadeIn").addClass("fadeOut"),e.$a.removeClass("slideInDown").addClass("slideOutUp"),t=setTimeout(function(){for(var t=0;t<e.eleArr.length;t++)e.eleArr[t].remove();e.option.alertCloseFun&&e.option.alertCloseFun()},1e3),e)}};var Select=function(t){this.$element=$("#"+t.target),this.inputWrap=".form-control-select-input",this.$inputWrap=this.$element.find(this.inputWrap),this.Input=".form-control-select-input input",this.$Input=this.$element.find(this.Input),this.deleteIcon=".form-control-select-delete",this.$deleteIcon=this.$element.find(this.deleteIcon),this.wrap=".form-control-select-wrap",this.$wrap=this.$element.find(this.wrap),this.searchInput=".form-control-select-search > input",this.$searchInput=this.$element.find(this.searchInput),this.resultWrap=".form-control-select-dialog",this.$resultWrap=this.$element.find(this.resultWrap),this.result=".form-control-select-result",this.$result=this.$element.find(this.result),this.resultItem=".form-control-select-result li",this.loading=".form-control-select-dialog > .form-control-select-loading",this.$loading=this.$element.find(this.loading),this.none=".form-control-select-dialog > .form-control-select-none",this.$none=this.$element.find(this.none),this.historyNone=".form-control-select-dialog > .form-control-select-history-none",this.$historyNone=this.$element.find(this.historyNone),this.param=t.param,this.url=t.url,this.storage=t.storage,this.page=1,this.flag=!0,this.closeState="search-select-close",this.openState="search-select-open",this.active="active",this.getParam=t.getParam||function(t){return!1},this.getData=t.getData||function(t){return!1},this.afterSelect=t.afterSelect||function(t,e){return!1},this.afterDelete=t.afterDelete||function(t,e){return!1}};Select.prototype.init=function(){this.eventHandler()},Select.prototype.show=function(){this.$wrap.show(),this.$searchInput.val("").focus(),this.$inputWrap.removeClass(this.closeState).addClass(this.openState),this.getHistoryData()},Select.prototype.hide=function(){this.$inputWrap.removeClass(this.openState).addClass(this.closeState),this.$wrap.hide()},Select.prototype.eventHandler=function(){var t=this;t.$element.on("click",t.inputWrap,function(){return!$(this).find("input").prop("disabled")&&void(t.$inputWrap.hasClass(t.closeState)?t.show():t.hide())}),t.$element.on("blur",t.searchInput,function(){window.setTimeout(function(){t.hide()},300)}),t.$element.on("focus",t.searchInput,function(){var e=$.trim($(this).val());""==e&&t.getHistoryData()}),t.$element.on("input",t.searchInput,function(){var e=$.trim($(this).val());if(t.page=1,""!=e){t.$historyNone.hide(),t.$loading.show();var i=t.getParam({keyword:e,pageno:t.page});if(!i)return!1;$.getJSON(t.url,i,function(i){return t.$loading.hide(),t.data=t.getData(i),!!t.data&&(t.$result.html(t.getHighLight(e,t.data.data)),void(t.page>t.data.total-1?t.next_page_url=null:t.next_page_url=t.url))})}else t.getHistoryData()}),t.$element.on("click",t.resultItem,function(){t.getSelectItem($(this))}),t.$element.on("click",t.deleteIcon,function(){t.deleteSelectItem(),$(this).hide()}),t.$resultWrap.scroll(function(e){var i=e.target;if(i.scrollTop+i.offsetHeight-i.scrollHeight>-10&&null!=t.next_page_url){if(0==t.flag)return!1;t.flag=!1,t.page++;var n=t.$element.find(t.searchInput).val(),o=t.getParam({keyword:n,pageno:t.page});if(!o)return!1;$.getJSON(t.next_page_url,o,function(e){t.data=t.getData(e);var i=t.getHighLight(n,t.data.data);t.$result.append(i),t.page>t.data.total-1?t.next_page_url=null:t.next_page_url=t.url,t.flag=!0})}})},Select.prototype.getHistoryData=function(){var t=this.storage;if(void 0==localStorage[t]||""==localStorage.searchHistory||"[]"==localStorage.searchHistory)this.$historyNone.show(),this.data="";else{this.$historyNone.hide();var e=localStorage[t];this.data=JSON.parse(e);var i=this.getDefaultResult(JSON.parse(e));this.$result.html(i)}},Select.prototype.deleteSelectItem=function(){this.$Input.val("").removeAttr("data-id"),this.afterDelete()},Select.prototype.getSelectItem=function(t){this.$Input.val(t.text()).attr("data-id",t.data("id")),this.$searchInput.val("").blur(),this.hide();var e=this.getHighLight(t.text(),this.data);this.$result.html(e),this.saveHistory(t.text(),t.data("id")),this.$deleteIcon.show(),this.afterSelect(t.text(),t.data("id"))},Select.prototype.saveHistory=function(t,e){var i,n,o=this.storage,a=localStorage[o]?JSON.parse(localStorage[o]):"";if(20==a.length&&a.pop(),i=void 0==a||""==a?[]:a,n='{"name":"'+t+'","id":"'+e+'"}',this.inArray(n,i)>=0){var s=this.inArray(n,i);i.splice(s,1)}i.unshift(n),this.data=i,localStorage[o]=JSON.stringify(i)},Select.prototype.inArray=function(t,e){for(var i=0;i<=e.length;i++)if(t.indexOf(e[i])!=-1)return i},Select.prototype.getDefaultResult=function(t){var e=t,i="";if(e.length>0){for(var n=0;n<e.length;n++){var o;o="string"==typeof e[n]?JSON.parse(e[n]):e[n],i+='<li data-id="'+o.name+'">'+o.name+"</li>"}return this.$historyNone.hide(),this.$none.hide(),this.$historyNone.hide(),i}return this.$historyNone.show(),!1},Select.prototype.getHighLight=function(t,e){var i=e,n="";if(i.length>0){for(var o=0;o<i.length;o++){var a;a="string"==typeof i[o]?JSON.parse(i[o]):i[o],a.name.indexOf(t)!=-1&&""!=t&&(n+='<li data-id="'+a.name+'">'+a.name.replace(t,"<em>"+t+"</em>")+"</li>")}return this.$historyNone.hide(),this.$none.hide(),this.$historyNone.hide(),n}return this.$none.show(),!1};var select=new Select({target:"searchHistory",url:"/app/mock/data.json",storage:"searchHistory",getData:function(t){return 0!=t.Agent_Company_listName.errcode?(console.log("error"),!1):(console.log(),{data:t.Agent_Company_listName.data.list,total:Math.ceil(t.Agent_Company_listName.data.total/20)})},afterSelect:function(t,e){console.log(t),console.log(e)},afterDelete:function(){console.log("delete")},getParam:function(t){t.status=99;var t={Agent:{Company:{listName:t}}};return t}});select.init();var DropDown=function(){};DropDown.prototype={init:function(t){this.config=$.extend(!0,{},t),this.$drop=this.config.ele,this.$toggle=this.$drop.find(".dropdown-toggle"),this.$menu=this.$drop.find(".dropdown-menu"),this.eventHandler()},eventHandler:function(){var t=this;t.$drop.on("mouseover",function(){t.$menu.show()}),t.$drop.on("mouseleave",function(){t.$menu.hide()})}};var Step=function(){this.index=0,this.config={onNext:function(){return!0},onShow:function(){},onPre:function(){return!0},onNavClick:function(){}}};Step.prototype={init:function(t){this.config=$.extend(!0,this.config,t),this.$steps=$(this.config.steps),this.limit=$(this.config.steps).length,this.navShow(),this.eventHandler()},eventHandler:function(){var t=this;$(t.$steps).on("click",t.config.nextEle,function(){if(t.config.onNext(t.index,this)){var e=t.index;e<t.limit-1&&(t.index=t.index+1,t.nexPage(e,t.index))}}),$(t.$steps).on("click",t.config.preEle,function(){if(t.config.onPre(t.index,this)){var e=t.index;e>0&&(t.index=t.index-1,t.nexPage(e,t.index))}})},nexPage:function(t,e){var i=this;e>t?($(i.$steps[t]).hasClass("done")||$(i.$steps[t]).addClass("done"),i.config.nav&&!$($(i.config.nav)[t]).hasClass("done")&&$($(i.config.nav)[t]).addClass("done"),$(i.$steps[t]).removeClass("active")):(i.config.nav&&$($(i.config.nav)[t]).removeClass("active"),$(i.$steps[t]).removeClass("active")),i.navShow()},navShow:function(){$(this.$steps).removeClass("active"),$(this.$steps[this.index]).addClass("active"),this.config.nav&&$(this.config.stepNav[this.index]).addClass("active"),this.config.onShow(this.index)},Go:function(t){return this.index=t,this.navShow(),this}};var Tab=function(){};Tab.prototype={init:function(t){this.config=t,this.$tabWrap=this.config.tabWrap,this.tab=this.config.tab,this.$tabTar=this.config.tabTar,this.tar=this.config.tar,this.eventHandler()},eventHandler:function(){var t=this;t.$tabWrap.off(),t.$tabWrap.on("click",t.tab,function(){t.$tabWrap.find(t.tab).removeClass("active"),t.$tabTar.find(t.tar).removeClass("active"),$(this).addClass("active");var e=$($(this).attr("data-target"));e.addClass("active")})}};